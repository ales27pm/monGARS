# monGARS Delivery Charter

> âš ï¸ Auto-generated by `scripts/manage_agents.py`. Update `configs/agents/agents_config.json` and rerun the script instead of editing this file manually.

## Scope

Applies to every repository change. Nested AGENTS.md files add stricter rules; this root charter
highlights the non-negotiable guardrails and shared context.

## Automation

- Generated via `python scripts/manage_agents.py refresh`. Edit the JSON profile instead of the
    Markdown when updating scope or requirements.
- Run `python scripts/manage_agents.py create <directory>` to scaffold a scoped AGENTS.md when a new
    subsystem lands.

## Roadmap Alignment

- **Security & Stability Hotlist**
  - âœ… Align JWT algorithm with deployed secrets (HS256 enforced until managed key storage is available).
  - âœ… Store runtime secrets in Vault/Sealed Secrets instead of raw `k8s/secrets.yaml`.
  - âœ… Update Dockerfiles to run as non-root and add a `.dockerignore` to exclude secrets and build artefacts.
  - ğŸ”„ Replace demo users in `web_api.py` with the database-backed authentication flow and migrations (default accounts still load at runtime and must be removed).
- **Phase 3 â€“ Hardware & Performance**
  - âœ… Worker auto-tuning for Pi/Jetson (`recommended_worker_count`).
  - âœ… Multi-architecture build scripts and cache metrics.
  - âœ… Hardened RBAC manifests.
  - âœ… Ray Serve HTTP integration with circuit breaking plus MNTP trainer support for LoRA and curated adapters.
  - âœ… Extend Alembic migrations for the newest SQLModel tables, including legacy tables created outside the current ORM layer.
  - âœ… Expose Ray Serve success/failure counters via OpenTelemetry (`llm.ray.*` metrics emitted by `LLMIntegration`).
- **Phase 5 â€“ Web/API Refinement**
  - âœ… FastAPI chat/history/token endpoints with validation.
  - âœ… Django chat UI with progressive enhancement.
  - âœ… FastAPI WebSocket handler with ticket verification, history replay, and streaming guarded by `WS_ENABLE_EVENTS`.
  - ğŸ”„ Replaced hard-coded credential stores with database-backed auth flows (the `DEFAULT_USERS` bootstrap in `monGARS/api/web_api.py` still provisions demo accounts until the cleanup lands).
  - ğŸš§ Publish polished SDKs and reference clients.

## Workflow Guardrails

- Target **Python 3.11** across tooling and CI.
- Format with `black` and `isort` using the repository `pyproject.toml` configuration.
- Run `pytest -q` before raising a pull request; record skipped suites and why.
- Document architecture, configuration, and operator workflows in `docs/` or the README when behaviour
    changes.

## Observability & Security

- Load configuration through `monGARS.config.get_settings()` so cached settings stay coherent across
    services.
- Redact secrets in logs and surface metrics via OpenTelemetry when you introduce background workers
    or retries.
- Keep Dockerfiles, build scripts, and Kubernetes manifests alignedâ€”when you touch one, review the
    others.

## Roadmap Integration

Use the focus list below to link workstreams with the active roadmap. The script keeps this section
current when the roadmap evolves.
