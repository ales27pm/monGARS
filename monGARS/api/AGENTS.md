# FastAPI Surface Standards

> ⚠️ Auto-generated by `scripts/manage_agents.py`. Update `configs/agents/agents_config.json` and rerun the script instead of editing this file manually.

## Scope

Applies to routers, schemas, WebSocket helpers, and auth utilities under `monGARS/api/`.

## Automation

- Refresh via the agents manager script to pick up roadmap changes or new endpoints.

## Roadmap Alignment

- **API Refinement**
  - ✅ FastAPI chat/history/token endpoints with validation.
  - ✅ Django chat UI with progressive enhancement.
  - ✅ FastAPI WebSocket handler with ticket verification, history replay, and streaming guarded by `WS_ENABLE_EVENTS`.
  - 🔄 Replace hard-coded credential stores with database-backed auth flows.
  - 🚧 Publish polished SDKs and reference clients.

## Endpoint Design

- Expose asynchronous routes returning typed Pydantic responses; centralise validation inside
    `schemas.py`.
- Register shared dependencies inside `dependencies.py` so tests can inject doubles.

## Security & Error Handling

- Flow authentication through `core.security.SecurityManager` and enforce bearer tokens on every route
    except `/ready` and `/healthz`.
- Translate domain errors into `HTTPException` codes; log unexpected failures with correlation IDs
    before bubbling up.

## Testing Hooks

Keep `tests/test_api_chat.py`, `tests/test_api_history.py`, and WebSocket suites aligned when
request/response contracts evolve.
