# Cognition Engine Protocol

> âš ï¸ Auto-generated by `scripts/manage_agents.py`. Update `configs/agents/agents_config.json` and rerun the script instead of editing this file manually.

## Scope

Guides orchestrators, schedulers, and memory abstractions under `monGARS/core/`.

## Automation

- Auto-generated; update `configs/agents/agents_config.json` and rerun `python
    scripts/manage_agents.py refresh` instead of editing charters manually.
- CI reruns the refresh in the docs-metadata guardrail and publishes `docs_metadata.patch` when drift
    is detectedâ€”apply it locally with `git apply docs_metadata.patch`.

## Roadmap Alignment

- **Performance & Resilience**
  - âœ… Worker auto-tuning for Pi/Jetson (`recommended_worker_count`).
  - âœ… Multi-architecture build scripts and cache metrics.
  - âœ… Hardened RBAC manifests.
  - âœ… Ray Serve HTTP integration with circuit breaking plus MNTP trainer support for LoRA and curated adapters.
  - âœ… Extend Alembic migrations for the newest SQLModel tables, including legacy tables created outside the current ORM layer.
  - âœ… Expose Ray Serve success/failure counters via OpenTelemetry (`llm.ray.*` metrics emitted by `LLMIntegration`).
- **Self-Improvement**
  - âœ… Personality profiles persisted via SQLModel with live adapter updates.
  - âœ… Self-training cycles produce real adapter artefacts via `modules.neurons.training.mntp_trainer.MNTPTrainer` with deterministic fallbacks.
  - âœ… Reinforcement-learning research loops run through the evolution orchestrator, operator approvals, and long-haul validator with telemetry and manifest updates.ã€F:modules/evolution_engine/orchestrator.pyâ€ L360-L440ã€‘ã€F:monGARS/core/long_haul_validation.pyâ€ L1-L220ã€‘
  - âœ… ResearchLongHaulService now schedules multi-replica soak runs and persists observability snapshots for dashboards, ensuring reinforcement pipelines stay healthy without manual triggers.ã€F:monGARS/core/research_validation.pyâ€ L1-L200ã€‘ã€F:monGARS/core/reinforcement_observability.pyâ€ L1-L168ã€‘ã€F:tests/test_research_long_haul_service.pyâ€ L1-L200ã€‘ã€F:tests/test_long_haul_validation.pyâ€ L200-L320ã€‘
- **Sustainability**
  - ğŸš§ Fully integrate evolution engine outputs into routine optimisation cycles.
  - ğŸš§ Automate energy usage reporting and advanced hardware-aware scaling using the energy tracker pipeline and reinforcement observability feeds as the baseline data source.ã€F:modules/evolution_engine/energy.pyâ€ L1-L160ã€‘ã€F:monGARS/core/reinforcement_observability.pyâ€ L1-L168ã€‘
  - ğŸš§ Share optimisation artefacts between nodes for faster convergence.

## Architectural Principles

- Keep orchestrators asynchronous, inject collaborators explicitly, and favour existing services
    (`AdaptiveResponseGenerator`, `ConversationalModule`, `PeerCommunicator`, `LongHaulValidation`)
    over ad-hoc state machines.
- Route UI events through `ui_events.event_bus`, persist approvals via `operator_approvals`, and
    coordinate sustainability metrics with `sustainability_dashboard` when adding new workflows.

## Operational Discipline

- Offload blocking work with `asyncio.to_thread` or executors and avoid sharing mutable globals across
    tasks.
- Emit metrics through `monGARS.telemetry`/OpenTelemetry where available and prefer timezone-aware
    timestamps (`datetime.now(datetime.UTC)`) in new code.
- Handle optional ML dependencies defensively with explicit fallbacks and structured warnings.

## Test Coverage

Expand cognition, reinforcement, and sustainability suites when behaviour
shiftsâ€”`tests/test_conversation_semantic_context.py`, `tests/test_llm_integration.py`,
`tests/test_peer_communication.py`, `tests/test_reinforcement_loop.py`,
`tests/test_long_haul_validation.py`, and `tests/test_sustainability_dashboard.py` anchor this area.
