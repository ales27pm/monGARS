# monGARS Package Contract

> ⚠️ Auto-generated by `scripts/manage_agents.py`. Update `configs/agents/agents_config.json` and rerun the script instead of editing this file manually.

## Scope

Covers the primary FastAPI app, cognition services, persistence layer, and shared utilities.

## Automation

- Auto-maintained via `scripts/manage_agents.py`.

## Roadmap Alignment

- **Runtime & Performance**
  - ✅ Worker auto-tuning for Pi/Jetson (`recommended_worker_count`).
  - ✅ Multi-architecture build scripts and cache metrics.
  - ✅ Hardened RBAC manifests.
  - ✅ Ray Serve HTTP integration with circuit breaking plus MNTP trainer support for LoRA and curated adapters.
  - 🔄 Extend Alembic migrations for the newest SQLModel tables, including legacy tables created outside the current ORM layer.
  - ✅ Expose Ray Serve success/failure counters via OpenTelemetry (`llm.ray.*` metrics emitted by `LLMIntegration`).
- **Networking & Collaboration**
  - ✅ Encrypted peer registry, admin-guarded endpoints, and distributed scheduler.
  - ✅ Sommeil Paradoxal idle-time optimisation and safe apply pipeline.
  - 🔄 Implement load-aware scheduling strategies and share optimisation telemetry across nodes.

## Dependency & Configuration Discipline

- Resolve configuration once with `monGARS.config.get_settings()` and inject dependencies via
    constructors or FastAPI dependency providers.
- Guard optional ML/serving libraries with availability checks and deliver graceful fallbacks with
    structured warnings.

## Logging & Persistence

- Emit logs via `logging.getLogger(__name__)` with scrubbed identifiers.
- Route database access through `core.persistence.PersistenceRepository` and align schemas with
    Alembic migrations in `alembic/`.
- Prefer caching helpers in `core.caching` / `core.hippocampus` and clear them explicitly inside
    tests.

## Testing Map

Update cognition and API suites together; relevant modules drive `tests/test_api_*.py`,
`tests/test_hippocampus.py`, and peers listed in the roadmap snapshot.
